<!DOCTYPE html>
<html>
  <head>
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/main.css') }}">
  </head>
  <body>
    <div id="map"></div>
    <div id="list"></div>
    <!-- scripts -->
    <script>
      var buildings = {{ buildings|tojson}};
    </script>
    <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBZcDdDorchlvUFV3VbiU-tqwTRU__47Ms&callback=initMap"
    async defer></script>
    <script src="{{ url_for('static', filename='bower_components/react/react.min.js') }}"></script>
    <script src="{{ url_for('static', filename='bower_components/react/react-dom.min.js') }}"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>
    <script src="{{ url_for('static', filename='scripts/js/main.js') }}"></script>
    <script>
      function initMap() {
        // Create a map object and specify the DOM element for display.
        var map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 34.397, lng: 50.644},
          scrollwheel: false,
          zoom: 2
        });

        var labels = [];
        var locations = [];
        for (var i=0; i<buildings.length; i++) {
          locations.push({lat: buildings[i].latitude, lng: buildings[i].longitude});
          labels.push(buildings[i].city+' '+ buildings[i].name);
        }

        var markers = locations.map(function(location, i) {
          return new google.maps.Marker({
            position: location,
            title: labels[i],
            icon : 'https://storage.googleapis.com/support-kms-prod/SNP_2752125_en_v0'
          });
        });

        // Add a marker clusterer to manage the markers.
        var markerCluster = new MarkerClusterer(map, markers,
            {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
      }

    </script>
  </body>
</html>